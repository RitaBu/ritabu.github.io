<!DOCTYPE html>
<html>
	<head>
		<title>chart created with amCharts | amCharts</title>
		<meta name="description" content="chart created using amCharts live editor" />

		<link rel="stylesheet" href="manoStilius.css" />
		
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
		<!-- amCharts javascript sources -->
		<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
		<script src="https://www.amcharts.com/lib/3/serial.js"></script>
		<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
		<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />

		<script src="https://www.amcharts.com/lib/3/themes/dark.js"></script>
		<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
		<script src="https://www.amcharts.com/lib/3/themes/patterns.js"></script>
		<script src="https://www.amcharts.com/lib/3/themes/black.js"></script>
		<script src="https://www.amcharts.com/lib/3/themes/chalk.js"></script>
		<script src="https://www.amcharts.com/lib/3/plugins/dataloader/dataloader.min.js" type="text/javascript"></script>
		<!-- amCharts javascript code -->
		<script type="text/javascript" src="makeChart.js"></script>
	</head>
	<body class="row justify-content-md-center">
		<h2 id="header" class="text-dark">Spalvų-žodžių testas</h2>
		<div class="column">
			<div class="row">
				<form class="form-inline">
					<label for="exerciseName" class="col-form-label col-form-label-sm">Užduotis:</label>
					<select class="form-control form-control-sm" id="exerciseName">
						<option value="1">Spalvos</option>
						<option value="2">Spavoti žodžiai</option>
						<option value="3">Spavotos spalvos</option>
					</select>
					<label for="seconds" class="col-form-label col-form-label-sm">Laikas:</label>
					<input type="number" class="form-control form-control-sm" id="seconds1">

					<label for="seconds" class="col-form-label col-form-label-sm">Laikas 2:</label>
					<input type="number" class="form-control form-control-sm" id="seconds2">

					<label for="seconds" class="col-form-label col-form-label-sm">Laikas 3:</label>
					<input type="number" class="form-control form-control-sm" id="seconds3">

					<button 
						onclick="onSubmit()"
						type="button" 
						class="form-control-sm btn btn-info" 
						id="submit-button">
						Pridėti
					</button>
					<div class="dropdown">
						<button class="btn btn-outline-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
							Tema
						</button>
						<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
							<a class="dropdown-item" id="none" onclick="changeTheme(id)">None</a>
							<a class="dropdown-item" id="light" onclick="changeTheme(id)">Light</a>
							<a class="dropdown-item" id="dark" onclick="changeTheme(id)">Dark</a>
							<a class="dropdown-item" id="black" onclick="changeTheme(id)">Black</a>
							<a class="dropdown-item" id="chalk" onclick="changeTheme(id)">Chalk</a>
							<a class="dropdown-item" id="patterns" onclick="changeTheme(id)">Patterns</a>
						</div>
					</div>
				</form>
			</div>
			<table id="results-table" class="table table-sm">
				<thead>
					<tr>
						<th scope="col">#</th>
						<th scope="col">Užduoties pavadinimas</th>
						<th scope="col">Pirmas bandymas</th>
						<th scope="col">Antras bandymas</th>
						<th scope="col">Trečias bandymas</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
				</tbody>
			</table>
		</div>
		<div id="chartdiv" style="width: 100%; height: 400px;"></div>
	</body>
	<script type="text/javascript">

		data = [];
		//$('#chartdiv')[0].setAttribute("display", "none");

		const updateTable = (array) => {
			let table = $('#results-table tbody')[0];
			table.innerHTML = "";
			array.forEach( (element, index) => {
				table.innerHTML += `<tr>
					<th scope="row"> ${index + 1} </th>
					<td> ${element.kortelesTipas} </td>
					<td> ${element.pirmasBandymas} </td>
					<td> ${element.antrasBandymas} </td>
					<td> ${element.treciasBandymas} </td>
					<td> <a onclick="deleteItem(${index})" href="#">Ištrinti</a> <td>
				</tr>`;
			});
		}

		updateTable(data);

		makeChart();

		const changeTheme = (element) => {
			theme = element;
			makeChart();
		};

		const onSubmit = () => {

			var eNameOption = document.getElementById("exerciseName");
			var eNameOptionValue = eNameOption.options[eNameOption.selectedIndex].value;

			var alreadyHaveIt = data.find(function(element) {
				return element.kortelesNumeris == eNameOptionValue;
			});

			if(!alreadyHaveIt) {
				let results = {
					kortelesNumeris: eNameOptionValue,
					kortelesTipas: eNameOption.options[eNameOption.selectedIndex].text,
					pirmasBandymas: $('#seconds1')[0].value !== null ? $('#seconds1')[0].value : "",
					antrasBandymas:  $('#seconds2')[0].value !== null ? $('#seconds2')[0].value : "",
					treciasBandymas: $('#seconds3')[0].value !== null ? $('#seconds3')[0].value : "",
				}

				data.push(results);
				updateTable(data);
				makeChart();

				 $('#seconds1')[0].value = "";
				 $('#seconds2')[0].value = "";
				 $('#seconds3')[0].value = "";
			}
			
		}

		const deleteItem = (index) => {
			if (index > -1) {
				data.splice(index, 1);
				updateTable(data);
				makeChart();
			}
		}

		updateTable([]);

	</script>
</html>
