<!DOCTYPE html>
<html lang="en">

    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- Bootstrap CSS -->
        <link href="../css/bootstrap.min.css"
              rel="stylesheet">
        <link href="../css/style.css"
              rel="stylesheet">
    </head>

    <body>
        <div class='customAlert'>
            <p class='message'></p>
            <input type='button'
                   class='confirmButton'
                   value='Gerai'
                   onclick=" $('.person_lost').hide();">
        </div>
        <div class="container-fluid header-top">
            <a href="../index.html">
            <img class="header_logo img-fluid" src="../img_lessons/100_small1.png">
        </a>
            <div class="progress-container">
                <ul style="text-align: center;">
                    <li>
                        <a href="level1-1.html">1</a>
                    </li>
                    <li>
                        <a href="level1-2.html">2</a>
                    </li>
                    <li>
                        <a href="level1-3.html">3</a>
                    </li>
                    <li>
                        <a href="level1-4.html">4</a>
                    </li>
                    <li>
                        <a class="active"
                           href="level1-5.html">5</a>
                    </li>
                    <li>
                        <a href="level1-6.html">6</a>
                    </li>
                    <li>
                        <a href="level1-7.html">7</a>
                    </li>
                    <li>
                        <a href="level1-8.html">8</a>
                    </li>
                    <li>
                        <a href="level1-9.html">9</a>
                    </li>
                    <li>
                        <a href="level1-10.html">10</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="container-fluid working-space">
            <div class="row"
                 style="padding: 10px;">
                <div class="col-md-5">
                    <h4>5. Baltijas ceļš: roku rokā, mans draugs</h4>
                </div>
                <div class=" col-md-7"
                     id="task">
                    Daži cilvēki ir apmaldījušies un nezina, kurp doties. Veicot programmēšanu, šādus jautājumus risina, izmantojot nosacījumus ("ja..., tad..."). Piemēram, "ja nogriezīsies pa kreisi, tad sasniegsi savu mērķi". Izveido nosacījumus tā, lai nebūtu atstarpju
                    starp cilvēkiem.
                </div>
            </div>
            <div class="row"
                 style="padding: 10px">
                <div class="col ">
                    <div id="preview">
                        <canvas id="canvas"
                                width="490"
                                height="330">
                        This text is displayed if your browser does not support HTML5 Canvas.
                    </canvas>
                        <div class="person"></div>
                        <div class="person2"></div>
                        <div class="person3"></div>
                        <div class="person_lost"></div>
                    </div>
                    <div class="button-panel">
                        <button class="button-run btn btn-lg btn-secondary"
                                onclick="runCode()">Starts </button>
                        <div class="hint-panel">
                            <ul> Norāde:
                                <li>
                                    <a tabindex="0"
                                       href="javascript:void(0)"
                                       data-toggle="popover"
                                       data-placement="top"
                                       data-trigger="focus"
                                       title=""
                                       data-text="Baltijas ceļa dalībnieku kreisā puse var neatbilst Tavai kreisajai pusei. Iedomājies sevi, stāvot starp viņiem.">1</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col"
                     style="padding: 0 ;">
                    <div id="blocklyDiv">
                    </div>
                    <xml id="toolbox"
                         style="display: none">
                        <category name="Nosacījums"
                                  colour="230">
                            <block type="keisti">
                            </block>
                            <block type="add_person_side">
                            </block>
                        </category>
                    </xml>
                </div>
                <div class="col-md-3 col-lg-2"
                     style="height: 70vh;">
                    <h5>Javascript kods: </h5>
                    <pre id="content_javascript">
                </pre>
                </div>
            </div>
            <div class="next-modal">
                <div class="modal fade"
                     id="nextModal"
                     tabindex="-1"
                     role="dialog"
                     aria-labelledby="nextModalLabel">
                    <div class="modal-dialog"
                         role="document">
                        <div class="modal-content">
                            <div class="modal-body">
                                <div>
                                    <h3>Susikibom!</h3>
                                </div>
                                <div class="modal-buttons">
                                    <a href="#"
                                       class="btn btn-secondary"
                                       data-dismiss="modal">Doties atpakaļ uz uzdevumu</a>
                                    <a href="level1-6.html"
                                       class="btn btn-secondary">Nākamais uzdevums</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"
                integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
                crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
                integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
                crossorigin="anonymous"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script src="../js/blockly_compressed.js"></script>
        <script src="../js/javascript_compressed.js"></script>
        <script src="../js/blocks_compressed.js"></script>
        <script src="../msg/js/lv.js"></script>
        <script src="../js/customBlocks.js"></script>
        <script src="../js/main.js"></script>
        <script src="../js/kelias.js"></script>
        <script type="text/javascript">
            var my_canvas = document.getElementById("canvas");
            var ctx = my_canvas.getContext("2d");
            var people = new Image();
            // var people_lv = new Image();
            // var people_est = new Image();
            // var girl = new Image();
            var step = 0;


            people.src = "../img_lessons/baltija/fonas-baltija.png";
            // people_lv.src = "../test_img/ppl.png";
            // people_est.src = "../test_img/ppl.png";
            // girl.src = "../test_img/girl.png";

            people.onload = function() {
                draw(people, 0, 0);
            };

            // girl.onload = function() {
            //     //draw(girl, 200, 10);
            // };

            function draw(pic_name, x, y) {
                ctx.drawImage(pic_name, x, y);
            }

            function draw_elements() {
                draw(people, 0, 0);
            }
        </script>
        <script>
            var workspace = Blockly.inject('blocklyDiv', {
                toolbox: document.getElementById('toolbox'),
                grid: {
                    spacing: 20,
                    length: 5,
                    colour: '#f2f2f2',
                    snap: true
                },
                trashcan: true
            });

            function toJavascript(event) {
                var code = Blockly.JavaScript.workspaceToCode(workspace);
                document.getElementById('content_javascript').innerHTML = code;
            }
            workspace.addChangeListener(toJavascript);
        </script>
        <script type="text/javascript">
            function runCode() {
                done = [];
                // Generate JavaScript code and run it.
                window.LoopTrap = 1000;
                Blockly.JavaScript.INFINITE_LOOP_TRAP =
                    'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
                var code = Blockly.JavaScript.workspaceToCode(workspace);
                Blockly.JavaScript.INFINITE_LOOP_TRAP = null;

                $('.person').hide().removeAttr('style');
                $('.person2').hide().removeAttr('style');
                $('.person3').hide().removeAttr('style');

                try {
                    if (code.length > 0) {
                        eval(code);
                        //console.log(done);
                        if (done.join('').split('').length == 3) {
                            setTimeout(function() {
                                $('#nextModal').modal('show');
                            }, 3000);
                        }

                    } else {
                        alert('Pievienot bloku.');
                    }

                } catch (e) {
                    alert('Kļūda! Lūdzu, pārbaudi blokus');
                }
            }
        </script>
    </body>

</html>