<!DOCTYPE html>
<html lang="en">

    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- Bootstrap CSS -->
        <link href="../css/bootstrap.min.css"
              rel="stylesheet">
        <link href="../css/style.css"
              rel="stylesheet">
    </head>

    <body>
        <div class='customAlert'>
            <p class='message'></p>
            <input type='button'
                   class='confirmButton'
                   value='Gerai'>
        </div>
        <div class="container-fluid header-top">
            <a href="../index.html">
            <img class="header_logo img-fluid" src="../img_lessons/100_small1.png">
        </a>
            <div class="progress-container">
                <ul style="text-align: center;">
                    <li>
                        <a href="level1-1.html">1</a>
                    </li>
                    <li>
                        <a href="level1-2.html">2</a>
                    </li>
                    <li>
                        <a href="level1-3.html">3</a>
                    </li>
                    <li>
                        <a href="level1-4.html">4</a>
                    </li>
                    <li>
                        <a href="level1-5.html">5</a>
                    </li>
                    <li>
                        <a href="level1-6.html">6</a>
                    </li>
                    <li>
                        <a href="level1-7.html">7</a>
                    </li>
                    <li>
                        <a class="active"
                           href="level1-8.html">8</a>
                    </li>
                    <li>
                        <a href="level1-9.html">9</a>
                    </li>
                    <li>
                        <a href="level1-10.html">10</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="container-fluid working-space">
            <div class="row"
                 style="padding: 10px;">
                <div class="col-md-5">
                    <h4>8. Cielaviņa ar atlaidi</h4>
                </div>
                <div class=" col-md-7"
                     id="task">
                    Nopelni dažus eiro, konvertē tos latos un nopērc kūku. Programmējot norādi, 
                    ka eiro tiek saņemti pēc uzklikšķināšanas eiro monētai un tad konvertēti latos, 
                    uzklikšķinot latu banknotei. Kad esi savācis atbilstošu summu, 
                    noklikšķini pogu "Pirkt" un baudi!
                </div>
            </div>
            <div class="row"
                 style="padding: 10px">
                <div class="col  ">
                    <div id="preview">
                        <canvas id="canvas"
                                width="490"
                                height="330">
                        This text is displayed if your browser does not support HTML5 Canvas.
                    </canvas>
                    </div>
                    <div class="button-panel">
                        <button class="button-run btn btn-lg btn-secondary"
                                onclick="runCode()">Starts </button>
                        <div class="hint-panel">
                            <ul> Norāde:
                                <li>
                                    <a tabindex="0"
                                       href="javascript:void(0)"
                                       data-toggle="popover"
                                       data-placement="top"
                                       data-trigger="focus"
                                       title=""
                                       data-text="Vai savāci pietiekami daudz eiro? Kūka maksā 10 Ls, tādēļ Tavā kontā jābūt vismaz 15 eiro.">1</a>
                                </li>
                                <li>
                                    <a tabindex="0"
                                       href="javascript:void(0)"
                                       data-toggle="popover"
                                       data-placement="top"
                                       data-trigger="focus"
                                       title=""
                                       data-text="Valūta tiek mainīta, uzklikšķinot uz latu banknotes, taču to vispirms vajag ieprogrammēt."
                                       data-full="../hints/L1T8_H2.png">2</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col"
                     style="padding: 0 ;">
                    <div id="blocklyDiv">
                    </div>
                    <xml id="toolbox"
                         style="display: none">
                        <category name="Valūta"
                                  colour="230">
                            <block type="pressed"></block>
                            <block type="change"></block>
                            <block type="ifas"></block>
                            <block type="convert"></block>
                        </category>
                    </xml>
                </div>
                <div class="col-md-3 col-lg-2"
                     style="height: 70vh;">
                    <h5>Javascript kods: </h5>
                    <pre id="content_javascript">
                </pre>
                </div>
            </div>
            <div class="next-modal">
                <div class="modal fade"
                     id="nextModal"
                     tabindex="-1"
                     role="dialog"
                     aria-labelledby="nextModalLabel">
                    <div class="modal-dialog"
                         role="document">
                        <div class="modal-content">
                            <div class="modal-body">
                                <div>
                                    <h3>Izdevās!</h3>
                                </div>
                                <div class="modal-buttons">
                                    <a href="#"
                                       class="btn btn-secondary"
                                       data-dismiss="modal">Doties atpakaļ uz uzdevumu</a>
                                    <a href="level1-9.html"
                                       class="btn btn-secondary">Nākamais uzdevums</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
                integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
                crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
                integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
                crossorigin="anonymous"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script src="../js/blockly_compressed.js"></script>
        <script src="../js/javascript_compressed.js"></script>
        <script src="../js/blocks_compressed.js"></script>
        <script src="../msg/js/lv.js"></script>
        <script src="../js/main.js"></script>
        <script src="../js/litai.js"></script>
        <script>
            var workspace = Blockly.inject('blocklyDiv', {
                toolbox: document.getElementById('toolbox'),
                grid: {
                    spacing: 20,
                    length: 5,
                    colour: '#f2f2f2',
                    snap: true
                },
                trashcan: true
            });

            function toJavascript(event) {
                var code = Blockly.JavaScript.workspaceToCode(workspace);
                document.getElementById('content_javascript').innerHTML = code;
            }
            workspace.addChangeListener(toJavascript);
        </script>
        <script type="text/javascript">
            var clicked;

            function runCode() {
                // Generate JavaScript code and run it.
                window.LoopTrap = 1000;
                Blockly.JavaScript.INFINITE_LOOP_TRAP =
                    'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
                var code = Blockly.JavaScript.workspaceToCode(workspace);
                Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
                //my_canvas.removeEventListener('click', clicked, false);
                $('canvas').off("click", clicked);
                lati = 0;
                eiro = 0;
                draw_elements();
                try {
                    if (code.length > 0) {
                        eval(code);
                    } else {
                        alert('Pievienot bloku.');
                    }

                } catch (e) {
                    alert('Kļūda! Lūdzu, pārbaudi blokus');
                }
            }
        </script>
    </body>

</html>